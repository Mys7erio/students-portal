import{w as P}from"./index-7b5ae4cd.js";const N={};var A=function(r,a){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(i[t]=o[t])},A(r,a)},E=function(){return E=Object.assign||function(r){for(var a,i=1,o=arguments.length;i<o;i++)for(var t in a=arguments[i])Object.prototype.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r},E.apply(this,arguments)};function q(r,a,i){if(i||arguments.length===2)for(var o,t=0,e=a.length;t<e;t++)!o&&t in a||(o||(o=Array.prototype.slice.call(a,0,t)),o[t]=a[t]);return r.concat(o||Array.prototype.slice.call(a))}var $={},U=new Set,v={},B=function(r){function a(){return r!==null&&r.apply(this,arguments)||this}return function(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function t(){this.constructor=i}A(i,o),i.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}(a,r),a}(Error);function g(r,a){if(typeof r=="string"||typeof r=="number"&&!isNaN(r)&&Math.abs(r)!==1/0||r==null||typeof r=="boolean")return r;var i=a.indexOf(r);if(i!==-1)return"#$@__instance__"+i;a.push(r);var o=a.length-1;if(r.constructor===Array){var t=r.map(function(s){return g(s,a)});return t.unshift("#$@__reference__"+o),t}if(r.constructor===Object){var e=Object.fromEntries(Object.entries(r).map(function(s){return[s[0],g(s[1],a)]}));return e["#$@__reference__"]=o,e}U.add(r.constructor);var n={};n=Object.defineProperty(n,"#$@__constructor__",{value:r.constructor.name,enumerable:!0}),n=Object.defineProperty(n,"#$@__reference__",{value:o,enumerable:!0});var u=function(s,c){if(Object.keys(v).includes(s.constructor.name))return v[s.constructor.name].toPlain(s,function(f){return g(f,c)})}(r,a);return u!==void 0?E(E({},u),n):(Object.getOwnPropertyNames(r).forEach(function(s){Object.defineProperty(n,s,{value:g(r[s],a),enumerable:!0})}),n)}function _(r,a,i){var o;if(typeof r=="string"&&r.indexOf("#$@__instance__")===0)return i[u=parseInt(r.slice(15))];if(typeof r=="string"||typeof r=="number"||r==null||typeof r=="boolean")return r;if(r.constructor===Array){if(r.length===0)return[];var t=r.shift();if(typeof t!="string"||t.substring(0,16)!=="#$@__reference__"){if(Object.keys(i).length===0)return r.unshift(t),r;throw new B}var e=[];i[u=t.slice(16)]=e;for(var n=0;n<r.length;n++)e[n]=_(r[n],a,i);return e}if(r.constructor===Object){var u;if((u=(o=r["#$@__reference__"])!==null&&o!==void 0?o:null)===null){if(Object.keys(i).length===0)return r;throw new B}if(delete r["#$@__reference__"],!Object.keys(r).includes("#$@__constructor__")){for(var s in e={},i[u]=e,r)e[s]=_(r[s],a,i);return e}var c=r["#$@__constructor__"];delete r["#$@__constructor__"];var f=function(h,p,w,O){if(Object.keys(v).includes(p))return v[p].fromPlain(h,function(m){return _(m,w,O)})}(r,c,a,i);if(f!==void 0)return f;if(!Object.keys(a).includes(c))throw new Error("The class "+c+" is not allowed");var l={};for(var s in i[u]=l,r)l[s]=_(r[s],a,i);return Object.setPrototypeOf(l,a[c].prototype),l}}function V(r){$[r.name]=r}(function(r,a){r("Date",i=>({time:i.getTime()}),function(i){let o=new Date;return o.setTime(i.time),o}),r("BigInt",i=>({number:i.toString()}),i=>BigInt(i.number)),r("String",i=>({text:i.toString()}),i=>new String(i.text)),r("RegExp",i=>({source:i.source,flags:i.flags}),i=>new RegExp(i.source,i.flags)),r("Number",function(i){let o={nan:!1,infinity:!1,positive:!0,number:null};return Math.abs(i)===1/0?(o.infinity=!0,o.positive=Math.abs(i)===i,o):isNaN(i)?(o.nan=!0,o):(o.number=i.valueOf(),o)},function(i){return i.nan?NaN:i.infinity?1/0*(i.positive?1:-1):new Number(i.number)}),r("Map",(i,o)=>({data:Array.from(i.entries()).map(t=>o(t))}),function(i,o){const t=new Map;return i.data.map(e=>o(e)).forEach(([e,n])=>t.set(e,n)),t}),r("Set",(i,o)=>({data:Array.from(i.values()).map(t=>o(t))}),function(i,o){const t=new Set;return i.data.map(e=>o(e)).forEach(e=>t.add(e)),t}),r("ArrayBuffer",(i,o)=>({data:o(new Uint8Array(i))}),(i,o)=>o(i.data).buffer),r("DataView",(i,o)=>({buffer:o(i.buffer),offset:i.byteOffset,length:i.byteLength}),(i,o)=>new DataView(o(i.buffer),i.offset,i.length)),[Error,EvalError,RangeError,AggregateError,ReferenceError,SyntaxError,TypeError,URIError,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array].forEach(i=>a(i))})(function(r,a,i){v[r]={toPlain:a,fromPlain:i}},V);var d,b={};(d=b).defaults={},d.set=function(r,a,i){var o=i||{},t=d.defaults,e=o.expires||t.expires,n=o.domain||t.domain,u=o.path!==void 0?o.path:t.path!==void 0?t.path:"/",s=o.secure!==void 0?o.secure:t.secure,c=o.httponly!==void 0?o.httponly:t.httponly,f=o.samesite!==void 0?o.samesite:t.samesite,l=e?new Date(typeof e=="number"?new Date().getTime()+864e5*e:e):0;document.cookie=r.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29")+"="+a.replace(/[^+#$&/:<-\[\]-}]/g,encodeURIComponent)+(l&&l.getTime()>=0?";expires="+l.toUTCString():"")+(n?";domain="+n:"")+(u?";path="+u:"")+(s?";secure":"")+(c?";httponly":"")+(f?";samesite="+f:"")},d.get=function(r){for(var a=document.cookie.split(";");a.length;){var i=a.pop(),o=i.indexOf("=");if(o=o<0?i.length:o,decodeURIComponent(i.slice(0,o).replace(/^\s+/,""))===r)return decodeURIComponent(i.slice(o+1))}return null},d.erase=function(r,a){d.set(r,"",{expires:-1,domain:a&&a.domain,path:a&&a.path,secure:0,httponly:0})},d.all=function(){for(var r={},a=document.cookie.split(";");a.length;){var i=a.pop(),o=i.indexOf("=");o=o<0?i.length:o,r[decodeURIComponent(i.slice(0,o).replace(/^\s+/,""))]=decodeURIComponent(i.slice(o+1))}return r};(function(){class r{constructor(e={}){const{allows:n,denies:u,requires:s,action:c,resource:f,behavior:l}=e;if(this._edit=!0,this._action=null,this._resource=null,this._behavior=null,this._allows=[],this._denies=[],this._requires={},"action"in e&&this.action(c),"resource"in e&&this.resource(f),"behavior"in e&&this.behavior(l),"allows"in e){if(n instanceof Array==0)throw new Error("permission allows illegal type");n.forEach(h=>this.allow(h))}if("denies"in e){if(u instanceof Array==0)throw new Error("permission denies illegal type");u.forEach(h=>this.deny(h))}if("requires"in e){if(s instanceof Object==0)throw new Error("permission requires illegal type");Object.entries(s).forEach(([h,p])=>this.require(h,p))}}edit(e){if(e===void 0)return this._edit;if(typeof e!="boolean")throw new Error("permission edit boolean required");return this._edit=e,this}action(e){if(e===void 0)return this._action;if(typeof e!="string")throw new Error("permission action string required");return this._action=e,this}resource(e){if(e===void 0)return this._resource;if(typeof e!="string")throw new Error("permission resource string required");return this._resource=e,this}behavior(e){if(e===void 0)return this._behavior;if(typeof e!="boolean")throw new Error("permission behavior boolean required");return this._behavior=e,this}allows(){return Object.freeze(this._allows)}allow(e){if(typeof e!="string")throw new Error("permission allow string required");if(this._allows.includes(e))throw new Error(`permission allow ${e} exists`);return this._allows.push(e),this}denies(){return Object.freeze(this._deniess)}deny(e){if(typeof e!="string")throw new Error("permission deny string required");if(this._denies.includes(e))throw new Error(`permission deny ${e} exists`);return this._denies.push(e),this}requires(){return Object.freeze(this._requires)}require(e,n){if(typeof e!="string")throw new Error("permission name string required");if(!(typeof n!="boolean"||typeof n!="number"||typeof n!="string"||n instanceof Array))throw new Error("permission value string or array required");return this._requires[e]=n,this}traverse(e,n){const u=e.split("."),s=u.pop();return u.forEach(c=>n=n[c]),[s,n]}validate(e,n,u){if(typeof u!="object"||typeof n!="string"||typeof e!="string"||this._action!==n||this._resource!==e)return!1;for(const s in this._requires){const[c,f]=this.traverse(s,u),l=this._requires[c],h=f[c];if(c in f){if(l instanceof Array&&l.includes(h)||l===h)continue;return!1}return!1}if(this._behavior)for(const s of this._denies){const[c,f]=this.traverse(s,u);if(c in f)return!1}else for(const s of this._allows){const[c,f]=this.traverse(s,u);if(c in f)return!1}return!0}valid(){return typeof this._action=="string"&&typeof this._resource=="string"&&typeof this._behavior=="boolean"}toJSON(){return{edit:this._edit,action:this._action,resource:this._resource,behavior:this._behavior,allows:this._allows,denies:this._denies,requires:this._requires}}}class a{constructor(e={}){const{name:n,active:u,permissions:s}=e;if(this._edit=!0,this._name=null,this._active=null,this._permissions=[],"name"in e&&this.name(n),"active"in e&&this.active(u),"permissions"in e){if(s instanceof Array==0)throw new Error("role permissions illegal type");s.forEach(c=>this.permission(c))}}edit(e){if(e===void 0)return this._edit;if(typeof e!="boolean")throw new Error("role edit boolean required");return this._edit=e,this}name(e){if(e===void 0)return this._name;if(typeof e!="string")throw new Error("role name string required");return this._name=e,this}active(e){if(e===void 0)return this._active;if(typeof e!="boolean")throw new Error("role active boolean required");return this._active=e,this}permissions(){return Object.freeze(this._permissions)}permission(){const e=new r(...arguments);return this.add(e),e}get(e,n){return this._permissions.find(u=>u.action()===n&&u.resource()===e)}add(e){if(e instanceof r==0)throw new Error("role add requires permission");const n=e.action(),u=e.resource();if(this._permissions.find(({_resource:s,_action:c})=>s===u&&c===n))throw new Error(`role add permission ${u} ${n} exists`);return this._permissions.push(e),this}validate(e,n,u){if(typeof u!="object"||typeof n!="string"||typeof e!="string"||this._active===!1)return!1;const s=this.get(e,n);return!!s&&s.validate(e,n,u)}valid(){if(typeof this._name!="string"||typeof this._active!="boolean")return!1;for(const e of this._permissions)if(e.valid()===!1)return!1;return!0}toJSON(){return{edit:this._edit,name:this._name,active:this._active,permissions:this._permissions.map(e=>e.toJSON())}}}class i{constructor(e={}){const{roles:n}=e;if(this._roles={},"roles"in e){if(n instanceof Array==0)throw new Error("access roles illegal type");n.forEach(u=>this.role(u))}}role(){const e=new a(...arguments);return this.add(e),e}get(e){if(e instanceof a==0)throw new Error("access get requires role");const n=e.name();return this._roles[n]}add(e){if(e instanceof a==0)throw new Error("access add requires role");const n=e.name();if(n in this._roles)throw new Error(`access add role ${n} exists`);return this._roles[n]=e,this}remove(e){if(e instanceof a==0)throw new Error("access remove requires role");const n=e.name();if(n in this._roles)throw new Error(`access remove role ${n} exists`);return delete this._roles[n],this}roles(){return Object.freeze(this._roles)}toJSON(){return this._roles}}const o={ENCODING:"hex",ITERATIONS:999999,KEY:32,TAG:16,SALT:16,VECTOR:12,RANDOM:20,HASH:"sha-512",ALGORITHM:"aes-256-gcm",Role:a,Access:i,Permission:r,role(){return new a(...arguments)},access(){return new i(...arguments)},permission(){return new r(...arguments)},async random(t){const e=this;t=t||e.RANDOM;const n=await e.randomBytes(t);return await e.bufferToHex(n)},async hash(t,e){const n=this;if(!t)throw new Error("Cyrup.hash - item argument required");e=n.normalizeHash(e||n.HASH);const u=await n.stringToBuffer(t),s=await n.createHash(u,e);return await n.bufferToHex(s)},async compare(t,e){const n=this;if(!e)throw new Error("Cyrup.compare - key argument required");if(!t)throw new Error("Cyrup.compare - password argument required");const u=await n.hexToBuffer(e.split(":")[1]);return await n.key(t,{salt:u})===e},async key(t,e){const n=this;if(!t)throw new Error("Cyrup.key - item argument required");(e=e||{}).size=e.size||n.KEY,e.salt=e.salt||n.SALT,e.iterations=e.iterations||n.ITERATIONS,e.hash=n.normalizeHash(e.hash||n.HASH);const[u,s]=await Promise.all([typeof t=="string"?n.stringToBuffer(t):t,typeof e.salt=="string"?n.stringToBuffer(e.salt):typeof e.salt=="number"?n.randomBytes(e.salt):e.salt]),c=await n.pbkdf2(u,s,e.iterations,e.size,e.hash),[f,l]=await Promise.all([n.bufferToHex(c),n.bufferToHex(s)]);return`${f}:${l}`},async encrypt(t,e,n,u){const s=this;if(!e)throw new Error("Cyrup.encrypt - key argument required");if(!t)throw new Error("Cyrup.encrypt - data argument required");e=e.split(":"),u=u||s.VECTOR,n=s.normalizeAlgorithm(n||s.ALGORITHM);const[c,f,l]=await Promise.all([s.hexToBuffer(e[0]),typeof t=="string"?s.stringToBuffer(t):t,typeof u=="string"?s.stringToBuffer(u):s.randomBytes(u)]),h=await s.cipher(n,c,l,f),[p,w]=await Promise.all([s.bufferToHex(h),s.bufferToHex(l)]);return`${p}:${w}`},async decrypt(t,e,n){const u=this;if(!e)throw new Error("Cyrup.decrypt - key argument required");if(!t)throw new Error("Cyrup.decrypt - data argument required");n=u.normalizeAlgorithm(n||u.ALGORITHM),e=e.split(":"),t=t.split(":");const[s,c,f]=await Promise.all([u.hexToBuffer(e[0]),u.hexToBuffer(t[0]),u.hexToBuffer(t[1])]),l=await u.decipher(n,s,f,c);return await u.bufferToString(l)}};if(typeof window>"u"){const t=N,e=N,n=t.promisify(e.pbkdf2),u=t.promisify(e.randomBytes);o.normalizeHash=function(s){return s.replace("-","").toLowerCase()},o.normalizeAlgorithm=function(s){return s.toLowerCase().indexOf("aes")!==0?s:s.toLowerCase()},o.hexToBuffer=async function(s){return Buffer.from(s,"hex")},o.bufferToHex=async function(s){return s.toString("hex")},o.stringToBuffer=async function(s){return Buffer.from(s,"utf8")},o.bufferToString=async function(s){return s.toString("utf8")},o.createHash=async function(s,c){return e.createHash(c).update(s).digest()},o.randomBytes=async function(s){return u(s)},o.pbkdf2=async function(s,c,f,l,h){return n(s,c,f,l,h)},o.cipher=async function(s,c,f,l){const h=e.createCipheriv(s,c,f);return Buffer.concat([h.update(l,"utf8"),h.final(),h.getAuthTag()])},o.decipher=async function(s,c,f,l){const h=this,p=Buffer.from(l,"hex"),w=p.slice(p.byteLength-h.TAG),O=p.slice(0,p.byteLength-h.TAG),m=e.createDecipheriv(s,c,f);return m.setAuthTag(w),Buffer.concat([m.update(O),m.final()])}}else o.normalizeHash=function(t){return t.toUpperCase()},o.normalizeAlgorithm=function(t){if(t.toLowerCase().indexOf("aes")!==0)return t;const e=t.split("-");return(e[0]+"-"+e[2]).toUpperCase()},o.getAuthTag=function(t){return t.slice(t.byteLength-this.TAG)},o.hexToBuffer=async function(t){if(typeof t!="string")throw new TypeError("Cyrup.hexToBuffer - expected input to be a string");if(t.length%2!=0)throw new RangeError("Cyrup.hexToBuffer - expected string to be an even number of characters");const e=new Uint8Array(t.length/2);for(let n=0,u=t.length;n<u;n+=2)e[n/2]=parseInt(t.substring(n,n+2),16);return e.buffer},o.bufferToHex=async function(t){const e=new Uint8Array(t),n=new Array(e.length);for(let u=0,s=e.length;u<s;u++)n[u]=("00"+e[u].toString(16)).slice(-2);return n.join("")},o.stringToBuffer=async function(t){const e=new Uint8Array(t.length);for(let n=0,u=t.length;n<u;n++)e[n]=t.charCodeAt(n);return e.buffer},o.bufferToString=async function(t){const e=new Uint8Array(t),n=new Array(e.length);for(let u=0,s=e.length;u<s;u++)n[u]=String.fromCharCode(e[u]);return n.join("")},o.createHash=async function(t,e){return window.crypto.subtle.digest(e,t)},o.randomBytes=async function(t){return window.crypto.getRandomValues(new Uint8Array(t))},o.pbkdf2=async function(t,e,n,u,s){const c=await window.crypto.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]),f=await window.crypto.subtle.deriveBits({salt:e,iterations:n,name:"PBKDF2",hash:{name:s}},c,u<<3);return new Uint8Array(f)},o.cipher=async function(t,e,n,u){const s=this,c=await window.crypto.subtle.importKey("raw",e,{name:t},!1,["encrypt"]);return await window.crypto.subtle.encrypt({iv:n,name:t,tagLength:8*s.TAG},c,u)},o.decipher=async function(t,e,n,u){const s=this,c=await window.crypto.subtle.importKey("raw",e,{name:t},!1,["decrypt"]);return await window.crypto.subtle.decrypt({iv:n,name:t,tagLength:8*s.TAG},c,u)};return o})();function y(r){let a,i=r[0],o=1;for(;o<r.length;){const t=r[o],e=r[o+1];if(o+=2,(t==="optionalAccess"||t==="optionalCall")&&i==null)return;t==="access"||t==="optionalAccess"?(a=i,i=e(i)):t!=="call"&&t!=="optionalCall"||(i=e((...n)=>i.call(a,...n)),a=void 0)}return i}var T;(function(r){r[r.EXCEPTION=0]="EXCEPTION",r[r.NO_ENCRYPTION=1]="NO_ENCRYPTION",r[r.NO_STORAGE=2]="NO_STORAGE"})(T||(T={}));T.EXCEPTION;const L=[],z=r=>{const a=typeof process<"u"&&y([process,"access",i=>i.env,"optionalAccess",i=>i.NODE_ENV])==="production";L.indexOf(r)!==-1||a||(typeof window>"u"&&(r+=`
Are you running on a server? Most of storages are not available while running on a server.`),console.warn(r),L.push(r))},x=r=>{z(`Unable to find the ${r}. No data will be persisted.`)};let R=function(r){return r===void 0?"undefined":JSON.stringify(g(r,[]))},S=function(r,a){if(a===void 0&&(a=void 0),typeof r!="string")return r;if(a===void 0&&(a={}),r!=="undefined"){a=Object.fromEntries(q(q([],Object.entries(a),!0),Object.entries($),!0));try{return _(JSON.parse(r),a,{})}catch{return r}}};function D(r,a,i){const o=a.getValue(i);return o!==null&&r.set(o),a.addListener&&a.addListener(i,t=>{r.set(t)}),r.subscribe(t=>{a.setValue(i,t)}),{...r,delete(){a.deleteValue(i)}}}function j(){}function G(r=j,a=j){const i=[];return{callListeners(o,t){t!==void 0&&i.filter(({key:e})=>e===o).forEach(({listener:e})=>e(t))},addListener(o,t){i.push({key:o,listener:t}),i.length===1&&r()},removeListener(o,t){const e=i.indexOf({key:o,listener:t});e!==-1&&i.splice(e,1),i.length===0&&a()}}}K();H();M();function k(r,a=!1){const i=n=>{const u=n.key;n.storageArea===r&&t(u,S(n.newValue))},{removeListener:o,callListeners:t,addListener:e}=G(()=>{a&&typeof window<"u"&&y([window,"optionalAccess",n=>n.addEventListener])&&window.addEventListener("storage",i)},()=>{a&&typeof window<"u"&&y([window,"optionalAccess",n=>n.removeEventListener])&&window.removeEventListener("storage",i)});return{addListener:e,removeListener:o,getValue(n){const u=r.getItem(n);return S(u)},deleteValue(n){r.removeItem(n)},setValue(n,u){r.setItem(n,R(u))}}}function H(r=!1){return typeof window<"u"&&y([window,"optionalAccess",a=>a.localStorage])?k(window.localStorage,r):(x("window.localStorage"),C())}function M(r=!1){return typeof window<"u"&&y([window,"optionalAccess",a=>a.sessionStorage])?k(window.sessionStorage,r):(x("window.sessionStorage"),C())}function K(){return typeof document>"u"||typeof y([document,"optionalAccess",r=>r.cookie])!="string"?(x("document.cookies"),C()):{getValue(r){const a=b.get(r);return S(a)},deleteValue(r){b.erase(r,{samesite:"Strict"})},setValue(r,a){b.set(r,R(a),{samesite:"Strict"})}}}var I;function C(){return{getValue:()=>null,deleteValue(){},setValue(){}}}(function(r){r[r.LOCAL=0]="LOCAL",r[r.SESSION=1]="SESSION",r[r.SYNC=2]="SYNC"})(I||(I={}));let J=D(P({loggedIn:!1}),H(),"LoginStatus");export{J as L};
